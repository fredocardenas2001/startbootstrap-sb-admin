extends ../layouts/dashboard.pug

block config
    - var bodyClass = 'sb-nav-fixed'
    - var pageTitle = 'Document Chat'
    - var sidenavStyle = 'sb-sidenav-dark'

block content
    #chat-entry
        <div class="cht-container">
            <div class="collapsible-container">
                <div class="chatHeader">
                    <button id="chatstat" class="collapsible">
                    <span id="chatNameLabel" class="chat-name-label" title="Start typing a message below or open a previous chat">No Chat Selected</span>
                    </button>
                </div>
                <div class="chatMenu">
                    <button class="collapsible" id="previousChatsBtn">Previous Chats</button>
                    <button class="collapsible" id="chatContext">Chat Context</button>
                    <button class="collapsible" onclick="clearChatWindow()">Clear Chat</button>
                </div>
            </div>
            <div class="chatStatusContainer" id="chatStatusContainer">
                <div class="chat-status" id="chatStatus"></div>
            </div>
            <div class="session-list-container" id="sessionListContainer">
                <div class="session-list" id="sessionList"></div>
            </div>
            <div id="directoryPanel" class="directory-panel hidden">
                <div id="directoryContainer"></div>
            </div>
            <div class="chat-container">
                <div class="chat-box" id="chatBox"></div>
                <div class="message-input-container">
                    <textarea id="messageInput" placeholder="Open a previous session or just ask a question" onkeydown="handleEnter(event)"></textarea>
                    <button id="webSearchToggle" type="button" aria-pressed="false" title="Web search: off">🖀</button>
                    <!-- 🌐   🖀      -->
                    <button onclick="sendMessage()">Send</button>
                </div>
            </div>
            <div id="showContextLinkContainer"></div>
            <!-- Holds "Show Files" or button -->
            <div id="debugData" style="display: none;"></div>
            <!-- JSON display -->
        </div>
            //- Rename Chat Modal
            #renameChatModal.modal
              .modal-content
                span.close(onclick="closeRenameModal()") ×
                h3 Rename Chat
                input#newChatName(type="text" placeholder="Enter new chat name")
                p
                  button(onclick="submitRenameChat()") Rename
                  button(onclick="closeRenameModal()") Cancel

            //- Delete Chat Modal
            #deleteChatModal.modal
              .modal-content
                span.close(onclick="closeDeleteModal()") ×
                h3 Delete Chat
                p
                  | We suggest saving your chat before you delete it since this is an 
                  strong irrecoverable action
                  | . Would you like to proceed?
                button(onclick="confirmDeleteChat()") Delete

            <!-- help modal -->
            #helpModal.modal
              .modal-content
                span.close ×
                h2 Chat Context
                p Enabling Chat Context allows you to limit queries to a specific subset of project documents.
                h3 How to Use Chat Context
                p 
                  strong Enable:
                  |  To enable, just move the slider. You will be redirected to the Data Directory page to set your search context.
                p 
                  strong Show Files:
                  |  Once the context is set, you may click the "Show Files" link to confirm which documents will be searched.
                p 
                  strong Update:
                  |  Takes you to the Directory page to set the search Context.
                p 
                  strong Disable:
                  |  To search all documents, just move the slider to the disabled state.
                h3 Note
                p 
                  strong Saved Chats:
                  | Chats with different chat contexts will be saved as separate chats.

            #servicePackageModal.modal
              .modal-content
                span.close ×
                h3 Enabled Packages
                table.service-table
                  tbody
                    tr
                      td
                        label
                          input(type="checkbox" name="package" value="basic")
                          |  Basic Support
                    tr
                      td
                        label
                          input(type="checkbox" name="package" value="pro")
                          |  Pro Support
                    tr
                      td
                        label
                          input(type="checkbox" name="package" value="enterprise")
                          |  Enterprise Support
                    tr
                      td
                        label
                          input(type="checkbox" name="package" value="analytics")
                          |  Analytics Suite
                    tr
                      td
                        label
                          input(type="checkbox" name="package" value="compliance")
                          |  Compliance Monitoring
                    tr
                      td
                        label
                          input(type="checkbox" name="package" value="training")
                          |  Training Sessions


append scripts
    script(type="module", src="js/chat-entry.js")
    script(src="js/showdown.min.js")


prepend css
    link(rel="stylesheet", href="assets/css/chat.css")
