extends ../layouts/dashboard.pug

block config
    - var bodyClass = 'sb-nav-fixed'
    - var pageTitle = 'Document Chat'
    - var sidenavStyle = 'sb-sidenav-dark'

block content
    #chat-entry.
        <div class="cht-container">
            <div class="collapsible-container">
                <div class="chatHeader">
                    <button id="chatstat" class="collapsible">
                    <span id="chatNameLabel" class="chat-name-label" title="Start typing a message below or open a previous chat">No Chat Selected</span>
                    </button>
                </div>
                <div class="chatMenu">
                    <button class="collapsible" id="previousChatsBtn">Previous Chats</button>
                    <button class="collapsible" id="chatContext">Chat Context</button>
                    <button class="collapsible" onclick="clearChatWindow()">Clear Chat</button>
                </div>
            </div>
            <div class="chatStatusContainer" id="chatStatusContainer">
                <div class="chat-status" id="chatStatus"></div>
            </div>
            <div class="session-list-container" id="sessionListContainer">
                <div class="session-list" id="sessionList"></div>
            </div>
            <div id="directoryPanel" class="directory-panel hidden">
                <div id="directoryContainer"></div>
            </div>
            <div class="chat-container">
                <div class="chat-box" id="chatBox"></div>
                <div class="message-input-container">
                    <textarea id="messageInput" placeholder="Open a previous session or just ask a question" onkeydown="handleEnter(event)"></textarea>
                    <button id="webSearchToggle" type="button" aria-pressed="false" title="Web search: off">🖀</button>
                    <!-- 🌐   🖀      -->
                    <button onclick="sendMessage()">Send</button>
                </div>
            </div>
            <div id="showContextLinkContainer"></div>
            <!-- Holds "Show Files" or button -->
            <div id="debugData" style="display: none;"></div>
            <!-- JSON display -->
        </div>
        <!-- Rename Chat Modal -->
        <div id="renameChatModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeRenameModal()">&times;</span>
                <h3>Rename Chat</h3>
                <input type="text" id="newChatName" placeholder="Enter new chat name">
                <p>
                    <button onclick="submitRenameChat()">Rename</button>
                    <button onclick="closeRenameModal()">Cancel</button>
            </div>
        </div>
        <!-- Delete Chat Modal -->
        <div id="deleteChatModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeDeleteModal()">&times;</span>
                <h3>Delete Chat</h3>
                <p>We suggest saving your chat before you delete it since this is an <strong>irrecoverable action</strong>. Would you like to proceed?</p>
                <button onclick="confirmDeleteChat()">Delete</button>
                <button onclick="closeDeleteModal()">Cancel</button>
            </div>
        </div>
        <!-- help modal -->
        <div id="helpModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Chat Context</h2>
                <p>Enabling Chat Context allows you to limit queries to a specific subset of project documents.</p>
                <h3>How to Use Chat Context</h3>
                <p><strong>Enable:</strong> To enable, just move the slider. You will be redirected to the Data Directory page to set your search context.</p>
                <p><strong>Show Files:</strong> Once the context is set, you may click the "Show Files" link to confirm which documents will be searched.</p>
                <p><strong>Update:</strong>Takes you to the Direcotry page to set the search Context.</p>
                <p><strong>Disable:</strong> To search all documents, just move the slider to the disabled state.</p>
                <h3>Note</h3>
                <p><strong>Saved Chats:</strong>Chats with different chat contexts will be saved as separate chats.</p>
            </div>
        </div>
        <!-- Service Packages placeholder -->
        <div id="servicePackageModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h3>Enabled Packages</h3>
                <table class="service-table">
                    <tbody>
                        <tr>
                            <td><label><input type="checkbox" name="package" value="basic"> Basic Support</label></td>
                        </tr>
                        <tr>
                            <td><label><input type="checkbox" name="package" value="pro"> Pro Support</label></td>
                        </tr>
                        <tr>
                            <td><label><input type="checkbox" name="package" value="enterprise"> Enterprise Support</label></td>
                        </tr>
                        <tr>
                            <td><label><input type="checkbox" name="package" value="analytics"> Analytics Suite</label></td>
                        </tr>
                        <tr>
                            <td><label><input type="checkbox" name="package" value="compliance"> Compliance Monitoring</label></td>
                        </tr>
                        <tr>
                            <td><label><input type="checkbox" name="package" value="training"> Training Sessions</label></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

append scripts
    script(type="module", src="js/chat-entry.js")
    script(src="js/showdown.min.js")


prepend css
    link(rel="stylesheet", href="assets/css/chat.css")
